(this["webpackJsonpreact-epic"]=this["webpackJsonpreact-epic"]||[]).push([[8],{263:function(e,t,n){"use strict";n.r(t);var a,c,r,i,d=n(24),l=n(63),o=n(248),s=n(161),j=n.n(s),u=n(162),b=n(127),h=n(111),O=n(249),x=n(253),p=n(0),g=n(58),f=n(259),m=n(260),v=n(261),w=n(89),S=n(92),I=n(258),y=n(152),k=n(264),F=n(25),C=n(163),N=n.n(C),U=n(4),$=f.a.Dragger,z=Object(p.createContext)(null),E=function(e){e.index;var t=Object(x.a)(e,["index"]),n=m.a.useForm(),a=Object(O.a)(n,1)[0];return Object(U.jsx)(m.a,{form:a,component:!1,children:Object(U.jsx)(z.Provider,{value:a,children:Object(U.jsx)("tr",Object(h.a)({},t))})})},J=function(e){e.title;var t=e.editable,n=e.children,a=e.dataIndex,c=e.record,r=e.handleSave,i=Object(x.a)(e,["title","editable","children","dataIndex","record","handleSave"]),d=Object(p.useState)(!1),l=Object(O.a)(d,2),o=l[0],s=l[1],g=Object(p.useRef)(null),f=Object(p.useContext)(z);Object(p.useEffect)((function(){o&&g.current.focus()}),[o]);var w=function(){s(!o),f.setFieldsValue(Object(b.a)({},a,c[a]))},S=function(){var e=Object(u.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f.validateFields();case 3:t=e.sent,w(),r(Object(h.a)(Object(h.a)({},c),t)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log("Save failed:",e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),I=n;return t&&(I=o?Object(U.jsx)(m.a.Item,{style:{margin:0},name:a,rules:[{required:!1}],children:Object(U.jsx)(v.a,{ref:g,onPressEnter:S,onBlur:S})}):Object(U.jsx)("div",{className:"editable-cell-value-wrap",style:{paddingRight:24},onClick:w,children:n})),Object(U.jsx)("td",Object(h.a)(Object(h.a)({},i),{},{children:I}))},M=function(){var e=Object(g.a)().ImageStore,t=Object(p.useState)({dataSource:[{key:"0",width:0,height:0,name:e.filename,thumb:e.serverFile.attributes.image.attributes.url}],count:1}),n=Object(O.a)(t,2),a=n[0],c=n[1],r=[{title:"\u6587\u4ef6\u540d",dataIndex:"name",width:"15%",render:function(e){return Object(U.jsx)("span",{children:e})}},{title:"\u56fe\u7247\u9884\u89c8",dataIndex:"thumb",render:function(e){return Object(U.jsx)(R,{src:e})}},{title:"\u6700\u5927\u5bbd\u5ea6\uff08\u53ef\u9009\uff09",dataIndex:"width",editable:!0,width:"25%",render:function(e){return e?Object(U.jsx)("div",{children:e}):0}},{title:"\u6700\u5927\u9ad8\u5ea6\uff08\u53ef\u9009\uff09",dataIndex:"height",editable:!0,width:"25%",render:function(e){return e?Object(U.jsx)("div",{children:e}):0}},{title:"\u64cd\u4f5c",dataIndex:"operation",render:function(){return Object(U.jsx)(w.a,{type:"primary",onClick:function(){return N()("".concat(a.dataSource[0].thumb,"?imageView2/0/w/").concat(a.dataSource[0].width,"/h/").concat(a.dataSource[0].height))&&S.b.success("\u6210\u529f\u590d\u5236\u5230\u526a\u8d34\u677f\uff01")},children:"\u590d\u5236\u94fe\u63a5"})}}],i=function(e){var t=Object(o.a)(a.dataSource),n=t.findIndex((function(t){return e.key===t.key})),r=t[n];t.splice(n,1,Object(h.a)(Object(h.a)({},r),e)),c(Object(h.a)(Object(h.a)({},a),{},{dataSource:t}))},d=a.dataSource,l={body:{row:E,cell:J}},s=r.map((function(e){return e.editable?Object(h.a)(Object(h.a)({},e),{},{onCell:function(t){return{record:t,editable:e.editable,dataIndex:e.dataIndex,title:e.title,handleSave:i}}}):e}));return Object(U.jsx)("div",{children:Object(U.jsx)(I.a,{components:l,rowClassName:function(){return"editable-row"},bordered:!0,dataSource:d,columns:s,pagination:!1})})},P=F.a.div(a||(a=Object(d.a)(["\n  margin-top: 30px;\n  border: 1px dashed #ccc;\n  padding: 20px;\n"]))),R=F.a.img(c||(c=Object(d.a)(["\n  max-width: 100px;\n"]))),V=F.a.div(r||(r=Object(d.a)(["\n  max-width: 480px;\n  margin: 0 auto;\n"]))),q=Object(l.a)((function(){var e=Object(g.a)(),t=e.ImageStore,n=e.UserStore,a={showUploadList:!1,beforeUpload:function(e){return t.setFile(e),t.setFilename(e.name),null===n.currentUser?(S.b.warning("\u8bf7\u5148\u767b\u5f55\u518d\u4e0a\u4f20!").then(),!1):/(svg$)|(png$)|(jpg$)|(jpeg$)|(gif$)/gi.test(e.type)?e.size>1048576?(S.b.error("\u56fe\u7247\u6700\u59271M").then(),!1):(t.upload().then((function(e){console.log("\u4e0a\u4f20\u6210\u529f"),console.log(e)})).catch((function(){console.log("\u4e0a\u4f20\u5931\u8d25")})),!1):(S.b.error("\u53ea\u80fd\u4e0a\u4f20 png/svg/jpg/gif \u683c\u5f0f\u7684\u56fe\u7247").then(),!1)}};return Object(U.jsx)("div",{children:Object(U.jsxs)(y.a,{tip:"\u4e0a\u4f20\u4e2d",spinning:t.isUploading,children:[Object(U.jsx)(V,{children:Object(U.jsxs)($,Object(h.a)(Object(h.a)({},a),{},{children:[Object(U.jsx)("p",{className:"ant-upload-drag-icon",children:Object(U.jsx)(k.a,{})}),Object(U.jsx)("p",{className:"ant-upload-text",children:"\u70b9\u51fb\u6216\u62d6\u62fd\u4e0a\u4f20\u56fe\u7247"}),Object(U.jsx)("p",{className:"ant-upload-hint",children:"\u4ec5\u652f\u6301 .png/.gif/.jpg/.svg \u683c\u5f0f\u7684\u56fe\u7247\uff0c\u56fe\u7247\u6700\u5927 1M"})]}))}),t.serverFile?Object(U.jsx)(P,{children:Object(U.jsx)(M,{})}):null]})})})),B=F.a.h1(i||(i=Object(d.a)(["\n  color: white;\n  font-size: 3em;\n  font-weight: 500;\n  line-height: 120%;\n  text-align: center;\n  margin-bottom: 50px;\n"]))),D=Object(l.a)((function(){return Object(U.jsxs)(U.Fragment,{children:[Object(U.jsx)(B,{children:"\u6b22\u8fce\u4e0a\u4f20\u4f60\u7684\u56fe\u7247"}),Object(U.jsx)(q,{})]})}));t.default=D}}]);
//# sourceMappingURL=8.8210e26a.chunk.js.map